<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>äºŒå¹´çº§æ•°å­¦æ¯æ—¥æŒ‘æˆ˜</title>
<style>
  :root {
    --primary: #4A90E2;
    --success: #2ECC71;
    --bg: #EEF2F5;
    --card-bg: #ffffff;
  }
  body {
    font-family: "Microsoft YaHei", sans-serif;
    background: var(--bg);
    margin: 0;
    padding: 20px;
    color: #333;
  }
  .container {
    max-width: 600px;
    margin: 0 auto;
    background: var(--card-bg);
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    padding: 25px;
  }
  h1, h2 { text-align: center; color: var(--primary); }
  
  /* ç™»å½•åŒºåŸŸ */
  .form-group { margin-bottom: 15px; }
  select, input {
    width: 100%;
    padding: 12px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
    box-sizing: border-box;
  }
  
  /* æŒ‰é’®é€šç”¨æ ·å¼ */
  .btn {
    width: 100%;
    padding: 14px;
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 50px;
    font-size: 1.1rem;
    cursor: pointer;
    margin-top: 10px;
    transition: all 0.2s;
  }
  .btn:active { transform: scale(0.98); }
  
  /* é¢˜ç›®å¡ç‰‡ */
  .question-card {
    background: #f8f9fa;
    border-left: 5px solid var(--primary);
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 8px;
  }
  .q-text { font-size: 1.1rem; font-weight: bold; margin-bottom: 15px; line-height: 1.5; }
  
  /* é€‰é¡¹æŒ‰é’®å®¹å™¨ */
  .options-grid {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 1fr;
    gap: 10px;
  }
  /* å•é€‰æŒ‰é’®ç¾åŒ– */
  .option-label {
    display: block;
    text-align: center;
    background: white;
    border: 2px solid #ddd;
    border-radius: 8px;
    padding: 10px 0;
    cursor: pointer;
    font-weight: bold;
    transition: 0.2s;
  }
  /* éšè—åŸå§‹ radio */
  .option-label input { display: none; }
  
  /* é€‰ä¸­çŠ¶æ€ */
  .option-label:has(input:checked) {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
  }

  /* ç»“æœé¡µ */
  #result-area { text-align: center; display: none; }
  .score-circle {
    width: 120px; height: 120px;
    background: var(--success);
    color: white;
    border-radius: 50%;
    line-height: 120px;
    font-size: 2.5rem;
    margin: 20px auto;
    font-weight: bold;
  }
  
  /* åŠ è½½é®ç½© */
  #loading {
    display: none; position: fixed; top:0; left:0; width:100%; height:100%;
    background: rgba(255,255,255,0.9); z-index: 99;
    justify-content: center; align-items: center; font-size: 1.2rem;
  }
</style>
</head>
<body>

<div class="container">
  
  <div id="login-area">
    <h1>ğŸ“ æ•°å­¦å°æµ‹éªŒ</h1>
    <div class="form-group">
      <select id="studentClass">
        <option value="">è¯·é€‰æ‹©ç­çº§...</option>
        <option value="2M">2M</option>
        <option value="2K">2K</option>
        <option value="2B">2B</option>
        <option value="2H">2H</option>
        <option value="2J">2J</option>
      </select>
    </div>
    <div class="form-group">
      <input type="text" id="studentName" placeholder="è¯·è¾“å…¥ä½ çš„åå­—">
    </div>
    <button class="btn" onclick="startQuiz()">å¼€å§‹æŒ‘æˆ˜</button>
  </div>

  <div id="quiz-area" style="display:none;">
    <h2>è¯·è®¤çœŸä½œç­” (å…±10é¢˜)</h2>
    <div id="questions-container"></div>
    <button class="btn" style="background:var(--success)" onclick="submitQuiz()">äº¤å·</button>
  </div>

  <div id="result-area">
    <h1>æäº¤æˆåŠŸ!</h1>
    <div class="score-circle"><span id="scoreVal">0</span>åˆ†</div>
    <p id="feedbackText"></p>
    <button class="btn" onclick="location.reload()">å†åšä¸€æ¬¡</button>
  </div>

</div>

<div id="loading">æ­£åœ¨ä¸Šä¼ æˆç»©ï¼Œè¯·ç¨ç­‰... ğŸš€</div>

<script>
// ==========================================
// ğŸ”´ è¯·åœ¨æ­¤å¤„å¡«å…¥ä½ çš„ GAS Web App URL
// ==========================================
const GAS_URL = "https://script.google.com/macros/s/AKfycbwt3G0ZQ44Tcy2PLM2VsPCMG23z9wIeeEDaIX6iEYPPwJ3G8okNr5JVCokrO3LBd-hu/exec"; 

// ====== é¢˜åº“æ•°æ® ======
const rawData = `
1,æ•°å­— 605 è¯»ä½œä»€ä¹ˆï¼Ÿ A. å…­ç™¾äº”å B. å…­ç™¾é›¶äº” C. å…­ç™¾äº”é›¶ D. å…­åäº”,B
2,é€‰å‡º â€œå…«ç™¾ä¸€åäºŒâ€ çš„æ•°å­—å†™æ³•ã€‚ A. 812 B. 821 C. 802 D. 820,A
3,åœ¨æ•°ç›® 492 ä¸­ï¼Œæ•°å­— 9 çš„æ•°ä½æ˜¯ä»€ä¹ˆï¼Ÿ A. ä¸ªä½ B. åä½ C. ç™¾ä½ D. åƒä½,B
4,åœ¨æ•°ç›® 735 ä¸­ï¼Œæ•°å­— 7 çš„æ•°å€¼æ˜¯å¤šå°‘ï¼Ÿ A. 7 B. 70 C. 700 D. 7000,C
5,å“ªä¸ªæ•°ç›®çš„åä½æ˜¯ 0ï¼Ÿ A. 310 B. 508 C. 420 D. 600,A
6,é€‰å‡ºæ¯” 550 å¤§ï¼Œä½†æ¯” 600 å°çš„æ•°ç›®ã€‚ A. 549 B. 589 C. 601 D. 650,B
7,å“ªä¸ªæ•°åˆ—æ˜¯é¡ºåºæ’åˆ—çš„ï¼Ÿ A. 210, 215, 220, 225 B. 300, 290, 280, 270 C. 105, 100, 110, 115 D. 450, 440, 460, 470,A
8,å®Œæˆæ•°åˆ—ï¼š100, 200, ( ), 400, 500ã€‚ A. 250 B. 300 C. 350 D. 600,B
9,426 çš„åä½è¿‘ä¼¼å€¼æ˜¯å¤šå°‘ï¼Ÿ A. 420 B. 430 C. 400 D. 500,A
10,875 çš„ç™¾ä½è¿‘ä¼¼å€¼æ˜¯å¤šå°‘ï¼Ÿ A. 800 B. 870 C. 880 D. 900,A
11,324 + 45 = A. 360 B. 369 C. 379 D. 469,B
12,208 + 560 = A. 708 B. 760 C. 768 D. 868,C
13,å“ªé¡¹ç®—å¼çš„ç­”æ¡ˆæœ€å¤§ï¼Ÿ A. 100 + 200 B. 150 + 100 C. 300 + 50 D. 200 + 250,D
14,458 - 32 = A. 420 B. 426 C. 436 D. 480,C
15,600 - 255 = A. 345 B. 355 C. 445 D. 455,A
16,980 - 120 - 50 = A. 800 B. 810 C. 860 D. 910,B
17,( ) - 150 = 300ã€‚æ‹¬å·é‡Œåº”å¡«å…¥ä»€ä¹ˆæ•°ç›®ï¼Ÿ A. 150 B. 250 C. 450 D. 500,C
18,è®¡ç®— 125 + 75 - 50 çš„ç­”æ¡ˆã€‚ A. 100 B. 150 C. 200 D. 250,C
19,6 X 4 = A. 10 B. 20 C. 24 D. 30,C
20,å“ªä¸ªç®—å¼ä»£è¡¨ â€œ5 ä¸ª 3â€ï¼Ÿ A. 5 + 3 B. 3 X 5 C. 5 - 3 D. 5 Ã·3,B
21,9 X 0 çš„ç­”æ¡ˆæ˜¯ï¼š A. 0 B. 1 C. 9 D. 90,A
22,7 X 10 = A. 7 B. 17 C. 70 D. 700,C
23,20 Ã· 5 A. 3 B. 4 C. 5 D. 6,B
24,48 Ã· 8 = A. 5 B. 6 C. 7 D. 8,B
25,ä»»ä½•æ•°ç›®é™¤ä»¥ 1ï¼Œç­”æ¡ˆæ˜¯ï¼š A. 0 B. 1 C. åŸåŸæœ¬æœ¬çš„æ•°ç›® D. 10,C
26,å¦ˆå¦ˆä¹°äº† 8 ä¸ªè‹¹æœï¼Œå¹³åˆ†ç»™ 2 ä¸ªå­©å­ï¼Œæ¯ä¸ªå­©å­å¾—å‡ ä¸ªï¼Ÿ A. 2 B. 4 C. 6 D. 16,B
27,åœè½¦åœºé‡Œæœ‰ 120 è¾†çº¢è½¦å’Œ 85 è¾†è“è½¦ã€‚åœè½¦åœºé‡Œä¸€å…±æœ‰å¤šå°‘è¾†è½¦ï¼Ÿ A. 195 B. 200 C. 205 D. 215,C
28,å”å”å…»äº† 350 åªé¸¡ï¼Œå–æ‰äº† 120 åªã€‚ä»–è¿˜å‰©ä¸‹å¤šå°‘åªé¸¡ï¼Ÿ A. 200 B. 230 C. 470 D. 500,B
29,ä¸€åªçŒ«æœ‰ 4 æ¡è…¿ã€‚5 åªçŒ«ä¸€å…±æœ‰å¤šå°‘æ¡è…¿ï¼Ÿ A. 9 B. 15 C. 20 D. 25,C
30,è€å¸ˆæœ‰ 40 é¢—ç³–æœï¼Œæ¯ä½å­¦ç”Ÿåˆ† 10 é¢—ï¼Œå¯ä»¥åˆ†ç»™å‡ ä½å­¦ç”Ÿï¼Ÿ A. 3 B. 4 C. 10 D. 50,B
`;

// è§£æé¢˜åº“
const allQuestions = rawData.trim().split('\n').map(line => {
  const lastComma = line.lastIndexOf(',');
  const firstComma = line.indexOf(',');
  // æå–ä¸­é—´çš„å†…å®¹ä½œä¸ºé¢˜ç›®ï¼ˆå«é€‰é¡¹æ–‡å­—ï¼‰
  const content = line.substring(firstComma + 1, lastComma).trim();
  // æå–æœ€åçš„å­—æ¯ä½œä¸ºç­”æ¡ˆ
  const answer = line.substring(lastComma + 1).trim();
  return { content, answer };
});

let currentQuestions = [];
let studentData = {};

function startQuiz() {
  const name = document.getElementById("studentName").value.trim();
  const cls = document.getElementById("studentClass").value;

  if (!name || !cls) { alert("è¯·å…ˆå¡«å†™ç­çº§å’Œå§“åï¼"); return; }
  studentData = { name, cls };

  // éšæœºæŠ½å–10é¢˜
  currentQuestions = allQuestions.sort(() => 0.5 - Math.random()).slice(0, 10);
  
  renderQuestions();
  document.getElementById("login-area").style.display = "none";
  document.getElementById("quiz-area").style.display = "block";
}

function renderQuestions() {
  const container = document.getElementById("questions-container");
  container.innerHTML = "";
  
  currentQuestions.forEach((q, index) => {
    // åˆ›å»ºé¢˜ç›®å¡ç‰‡
    const div = document.createElement("div");
    div.className = "question-card";
    div.innerHTML = `
      <div class="q-text">${index + 1}. ${q.content}</div>
      <div class="options-grid">
        <label class="option-label">
          <input type="radio" name="q${index}" value="A"> A
        </label>
        <label class="option-label">
          <input type="radio" name="q${index}" value="B"> B
        </label>
        <label class="option-label">
          <input type="radio" name="q${index}" value="C"> C
        </label>
        <label class="option-label">
          <input type="radio" name="q${index}" value="D"> D
        </label>
      </div>
    `;
    container.appendChild(div);
  });
}

async function submitQuiz() {
  // 1. æ£€æŸ¥æ˜¯å¦å…¨éƒ¨åšå®Œ
  let scoreCount = 0;
  for (let i = 0; i < currentQuestions.length; i++) {
    const selected = document.querySelector(`input[name="q${i}"]:checked`);
    if (!selected) {
      alert(`ç¬¬ ${i+1} é¢˜è¿˜æ²¡åšå“¦ï¼`);
      return;
    }
    if (selected.value === currentQuestions[i].answer) {
      scoreCount++;
    }
  }

  const finalScore = scoreCount * 10; // 10é¢˜ï¼Œæ¯é¢˜10åˆ†

  // 2. æ˜¾ç¤ºLoading
  document.getElementById("loading").style.display = "flex";

  // 3. æ„å»ºæ•°æ®
  const payload = {
    name: studentData.name,
    class: studentData.cls,
    score: finalScore,
    total: 10
  };

  // 4. å‘é€æ•°æ® (ä½¿ç”¨ no-cors å’Œ text/plain ç¡®ä¿é€è¾¾)
  try {
    await fetch(GAS_URL, {
      method: "POST",
      mode: "no-cors", 
      headers: { "Content-Type": "text/plain" },
      body: JSON.stringify(payload)
    });

    // 5. æ˜¾ç¤ºç»“æœ
    document.getElementById("quiz-area").style.display = "none";
    document.getElementById("result-area").style.display = "block";
    document.getElementById("scoreVal").innerText = finalScore;
    
    // è¯„è¯­
    const fb = document.getElementById("feedbackText");
    if(finalScore === 100) fb.innerText = "ğŸŒŸ å¤ªæ£’äº†ï¼Œä½ æ˜¯æ•°å­¦å°å¤©æ‰ï¼";
    else if(finalScore >= 80) fb.innerText = "ğŸ‘ æˆç»©å¾ˆæ£’ï¼Œç»§ç»­ä¿æŒï¼";
    else fb.innerText = "ğŸ’ª åˆ«ç°å¿ƒï¼Œä¸‹æ¬¡ä¸€å®šèƒ½è€ƒå¥½ï¼";

  } catch (err) {
    console.error(err);
    alert("æäº¤æ—¶ç½‘ç»œæœ‰ç‚¹é—®é¢˜ï¼Œè¯·æˆªå›¾æˆç»©å‘ç»™è€å¸ˆã€‚");
  } finally {
    document.getElementById("loading").style.display = "none";
  }
}
</script>
</body>
</html>
